<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title></title>
</head>

<body>
  
</body>

</html>
<!doctype html>
<html lang="ar">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ â€” ØªÙØ§Ø¹Ù„ÙŠ</title>
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;700;900&display=swap" rel="stylesheet">
<style>
  :root{
    --bg-1: #2b1f4d;
    --bg-2: #5b3ea6;
    --glass-bg: rgba(255,255,255,0.05);
    --glass-border: rgba(255,255,255,0.12);
    --accent: #ffffff;
    --glass-radius: 20px;
    --card-w: min(980px,94vw);
    --card-h: min(780px,92vh);
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;font-family:'Tajawal',sans-serif;direction:rtl;background:linear-gradient(135deg,var(--bg-1),var(--bg-2));display:flex;align-items:center;justify-content:center;color:var(--accent)}
  .stage{width:100%;height:100%;display:flex;align-items:center;justify-content:center;padding:20px}
  .glass{
    width:var(--card-w);
    height:var(--card-h);
    border-radius:var(--glass-radius);
    background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
    border:1px solid rgba(255,255,255,0.08);
    box-shadow: 0 20px 50px rgba(2,6,23,0.6), inset 0 1px 0 rgba(255,255,255,0.02);
    padding:18px;display:flex;flex-direction:column;position:relative;overflow:hidden;
    backdrop-filter: blur(10px) saturate(120%);
  }
  .topbar{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
  .title{font-size:20px;font-weight:800}
  .timer{font-size:16px}
  .viewer{flex:1;border-radius:14px;background:transparent;position:relative;overflow:auto;padding:12px}
  .controls{display:flex;gap:10px;align-items:center;justify-content:center;margin-top:12px}
  button.primary{background:linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));border:1px solid rgba(255,255,255,0.08);padding:12px 18px;border-radius:12px;color:var(--accent);cursor:pointer;font-weight:700}
  button.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:10px 14px;border-radius:10px;color:var(--accent);cursor:pointer}
  .page{display:none;padding:18px;height:100%;box-sizing:border-box}
  .page.active{display:block}
  .center-box{max-width:880px;margin:0 auto}
  label.small{display:block;color:rgba(255,255,255,0.8);margin-bottom:6px;font-weight:600}
  input[type="text"], input[type="password"], textarea, select{
    width:100%;padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.06);background:rgba(255,255,255,0.02);color:var(--accent);outline:none;font-size:15px;box-shadow: inset 0 2px 8px rgba(0,0,0,0.2);
  }
  textarea{min-height:120px;resize:vertical}
  .row{display:flex;gap:12px;align-items:center}
  .muted{color:rgba(255,255,255,0.7);font-size:13px}
  .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:12px;padding:12px;border:1px solid rgba(255,255,255,0.04);margin-bottom:12px}
  /* MCQ styles */
  .mcq-question{padding:12px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);margin-bottom:10px;background:rgba(0,0,0,0.02)}
  .opt{padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);cursor:pointer;margin-top:8px;background:rgba(255,255,255,0.01)}
  .opt.selected{outline:2px solid rgba(0,200,120,0.25);box-shadow:0 6px 18px rgba(0,0,0,0.35)}
  /* result big number */
  .result-big{font-size:64px;font-weight:900}
  .celebrate{position:absolute;inset:0;pointer-events:none;display:flex;align-items:center;justify-content:center;z-index:1}
  /* modals (glass) */
  .modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.45);display:flex;align-items:center;justify-content:center;z-index:9999}
  .modal-card{width:min(520px,92%);background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));border-radius:16px;padding:18px;border:1px solid rgba(255,255,255,0.08);box-shadow:0 12px 40px rgba(0,0,0,0.7)}
  /* green circular check */
  .check-circle{width:84px;height:84px;border-radius:50%;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,#2bbf8a,#12a07a);box-shadow:0 6px 18px rgba(14,86,65,0.25);border:6px solid rgba(255,255,255,0.06);transform:translateY(0)}
  .check-icon{width:44px;height:44px;color:#fff;font-weight:900;display:flex;align-items:center;justify-content:center;font-size:34px}
  /* little animation for appearing message */
  .enter-notify{position:fixed;left:50%;transform:translateX(-50%);top:12vh;z-index:9998;transition:all .22s ease;opacity:0;pointer-events:none}
  .enter-notify.show{opacity:1;transform:translateX(-50%) translateY(0)}
  /* small style tweaks */
  @media (max-width:820px){ .glass{width:96vw;height:92vh;padding:12px} .result-big{font-size:44px} .check-circle{width:64px;height:64px} }
</style>
</head>
<body>
<div class="stage">
  <div class="glass" role="application" aria-label="Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ">
    <div class="topbar">
      <div class="title">Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</div>
      <div class="timer" id="timerDisplay">Ø§Ù„ÙˆÙ‚Øª: 12:00</div>
    </div>

    <div class="viewer" id="viewer">
      <!-- ØµÙØ­Ø© 1: Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© -->
      <section id="page-1" class="page active">
        <div class="center-box">
          <h2 style="font-weight:800;margin-bottom:8px">Ù…Ø±Ø­Ø¨Ø§ â€” Ø§Ù…Ù„Ø£ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</h2>
          <div class="card">
            <label class="small">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label>
            <input id="studentName" type="text" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù…" />
            <div style="height:8px"></div>
            <label class="small">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
            <input id="studentEmail" type="text" placeholder="example@mail.com" />
            <div style="height:8px"></div>
            <label class="small">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
            <input id="studentPhone" type="text" placeholder="015xxxxxxxx" />
            <div style="height:8px"></div>
            <label class="small">Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©</label>
            <input id="studentProvince" type="text" placeholder="Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©" />
            <div style="height:12px"></div>
            <div style="display:flex;justify-content:flex-end">
              <button id="startBtn" class="primary">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</button>
            </div>
            <div style="height:8px"></div>
            <div class="muted">Ø¨Ø¹Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ø¨Ø¯Ø£ØŒ Ø³ÙŠØ¨Ø¯Ø£ Ø§Ù„Ù…Ø¤Ù‚Øª ÙˆÙ„Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø©.</div>
          </div>
        </div>
      </section>

      <!-- ØµÙØ­Ø§Øª Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ 2..8 (ÙƒÙ„ ØµÙØ­Ø© Ø¨Ù†ÙØ³ Ø§Ù„Ø§Ø³ØªØ§ÙŠÙ„) -->
      <section id="page-2" class="page">
        <div class="center-box">
          <h3>Ù…Ø§ Ù‡Ùˆ ÙƒÙˆØ¯ Ø³ÙŠØ´Ù† Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø£ÙˆÙ„ØŸ</h3>
          <div style="height:12px"></div>
          <div class="card">
            <input id="codeP2" type="text" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„ÙƒÙˆØ¯ Ù‡Ù†Ø§" />
            <div style="height:12px"></div>
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div class="muted">Ø§ÙƒØªØ¨ Ø§Ù„ÙƒÙˆØ¯ Ø«Ù… Ø§Ø¶ØºØ· Ø§Ù„ØªØ§Ù„ÙŠ</div>
              <div>
                <button id="nextP2" class="primary">Ø§Ù„ØªØ§Ù„ÙŠ</button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section id="page-3" class="page">
        <div class="center-box">
          <h3>Ù…Ø§ Ù‡Ùˆ ÙƒÙˆØ¯ Ø³ÙŠØ´Ù† Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø«Ø§Ù†ÙŠØŸ</h3>
          <div style="height:12px"></div>
          <div class="card">
            <input id="codeP3" type="text" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„ÙƒÙˆØ¯ Ù‡Ù†Ø§" />
            <div style="height:12px"></div>
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div class="muted">Ø§ÙƒØªØ¨ Ø§Ù„ÙƒÙˆØ¯ Ø«Ù… Ø§Ø¶ØºØ· Ø§Ù„ØªØ§Ù„ÙŠ</div>
              <div><button id="nextP3" class="primary">Ø§Ù„ØªØ§Ù„ÙŠ</button></div>
            </div>
          </div>
        </div>
      </section>

      <section id="page-4" class="page">
        <div class="center-box">
          <h3>Ù…Ø§ Ù‡Ùˆ ÙƒÙˆØ¯ Ø³ÙŠØ´Ù† Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø«Ø§Ù„Ø«ØŸ</h3>
          <div style="height:12px"></div>
          <div class="card">
            <input id="codeP4" type="text" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„ÙƒÙˆØ¯ Ù‡Ù†Ø§" />
            <div style="height:12px"></div>
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div class="muted">Ø§ÙƒØªØ¨ Ø§Ù„ÙƒÙˆØ¯ Ø«Ù… Ø§Ø¶ØºØ· Ø§Ù„ØªØ§Ù„ÙŠ</div>
              <div><button id="nextP4" class="primary">Ø§Ù„ØªØ§Ù„ÙŠ</button></div>
            </div>
          </div>
        </div>
      </section>

      <section id="page-5" class="page">
        <div class="center-box">
          <h3>Ù…Ø§ Ù‡Ùˆ ÙƒÙˆØ¯ Ø³ÙŠØ´Ù† Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø±Ø§Ø¨Ø¹ØŸ</h3>
          <div style="height:12px"></div>
          <div class="card">
            <input id="codeP5" type="text" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„ÙƒÙˆØ¯ Ù‡Ù†Ø§" />
            <div style="height:12px"></div>
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div class="muted">Ø§ÙƒØªØ¨ Ø§Ù„ÙƒÙˆØ¯ Ø«Ù… Ø§Ø¶ØºØ· Ø§Ù„ØªØ§Ù„ÙŠ</div>
              <div><button id="nextP5" class="primary">Ø§Ù„ØªØ§Ù„ÙŠ</button></div>
            </div>
          </div>
        </div>
      </section>

      <section id="page-6" class="page">
        <div class="center-box">
          <h3>Ù…Ø§ Ù‡Ùˆ ÙƒÙˆØ¯ Ø³ÙŠØ´Ù† Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø®Ø§Ù…Ø³ØŸ</h3>
          <div style="height:12px"></div>
          <div class="card">
            <input id="codeP6" type="text" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„ÙƒÙˆØ¯ Ù‡Ù†Ø§" />
            <div style="height:12px"></div>
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div class="muted">Ø§ÙƒØªØ¨ Ø§Ù„ÙƒÙˆØ¯ Ø«Ù… Ø§Ø¶ØºØ· Ø§Ù„ØªØ§Ù„ÙŠ</div>
              <div><button id="nextP6" class="primary">Ø§Ù„ØªØ§Ù„ÙŠ</button></div>
            </div>
          </div>
        </div>
      </section>

      <section id="page-7" class="page">
        <div class="center-box">
          <h3>Ù…Ø§ Ù‡Ùˆ ÙƒÙˆØ¯ Ø³ÙŠØ´Ù† Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø³Ø§Ø¯Ø³ØŸ</h3>
          <div style="height:12px"></div>
          <div class="card">
            <input id="codeP7" type="text" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„ÙƒÙˆØ¯ Ù‡Ù†Ø§" />
            <div style="height:12px"></div>
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div class="muted">Ø§ÙƒØªØ¨ Ø§Ù„ÙƒÙˆØ¯ Ø«Ù… Ø§Ø¶ØºØ· Ø§Ù„ØªØ§Ù„ÙŠ</div>
              <div><button id="nextP7" class="primary">Ø§Ù„ØªØ§Ù„ÙŠ</button></div>
            </div>
          </div>
        </div>
      </section>

      <section id="page-8" class="page">
        <div class="center-box">
          <h3>Ù…Ø§ Ù‡Ùˆ ÙƒÙˆØ¯ Ø³ÙŠØ´Ù† Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ Ø§Ù„Ø³Ø§Ø¨Ø¹ØŸ</h3>
          <div style="height:12px"></div>
          <div class="card">
            <input id="codeP8" type="text" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„ÙƒÙˆØ¯ Ù‡Ù†Ø§" />
            <div style="height:12px"></div>
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div class="muted">Ø§ÙƒØªØ¨ Ø§Ù„ÙƒÙˆØ¯ Ø«Ù… Ø§Ø¶ØºØ· Ø§Ù„ØªØ§Ù„ÙŠ</div>
              <div><button id="nextP8" class="primary">Ø§Ù„ØªØ§Ù„ÙŠ</button></div>
            </div>
          </div>
        </div>
      </section>

      <!-- ØµÙØ­Ø© 9: MCQ -->
      <section id="page-9" class="page">
        <div class="center-box">
          <h3>Ø£Ø³Ø¦Ù„Ø© Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ù…ØªØ¹Ø¯Ø¯</h3>
          <div class="muted">Ø§Ø®ØªØ± Ø¥Ø¬Ø§Ø¨Ø© Ù„ÙƒÙ„ Ø³Ø¤Ø§Ù„ â€” Ø¥Ø¬Ø§Ø¨Ø§ØªÙƒ Ø³ØªÙØ³Ø¬Ù‘ÙÙ„ ÙƒÙ…Ø§ Ø§Ø®ØªØ±ØªÙ‡Ø§.</div>
          <div style="height:12px"></div>
          <div id="mcqList" style="max-height:520px;overflow:auto;padding-right:6px"></div>
          <div style="height:10px"></div>
          <div style="display:flex;justify-content:flex-end"><button id="nextFromMCQ" class="primary">Ø§Ù„ØªØ§Ù„ÙŠ</button></div>
        </div>
      </section>

      <!-- ØµÙØ­Ø© 10: Essays (10 questions) -->
      <section id="page-10" class="page">
        <div class="center-box">
          <h3>Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ù…Ù‚Ø§Ù„ÙŠØ©</h3>
          <div class="muted">Ø§ÙƒØªØ¨ Ø¥Ø¬Ø§Ø¨Ø§ØªÙƒ Ø¨ØµØ±Ø§Ø­Ø© â€” Ø³ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„Ù‡Ø§ ÙƒÙ…Ø§ ÙƒØªØ¨ØªÙ‡Ø§.</div>
          <div style="height:12px"></div>
          <div id="essaysContainer" style="max-height:520px;overflow:auto;padding-right:6px"></div>
          <div style="height:12px"></div>
          <div style="display:flex;justify-content:flex-end"><button id="toResult" class="primary">Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªÙŠØ¬Ø©</button></div>
        </div>
      </section>

      <!-- ØµÙØ­Ø© 11: Ø§Ù„Ù†ØªÙŠØ¬Ø© -->
      <section id="page-11" class="page">
        <div class="center-box" style="position:relative;z-index:2">
          <h2 style="margin-bottom:8px">Ø§Ù„Ù†ØªÙŠØ¬Ø©</h2>
          <div style="height:8px"></div>
          <div style="display:flex;gap:18px;align-items:center">
            <div>
              <div class="result-big" id="scorePct">--%</div>
              <div class="muted">Ø¯Ø±Ø¬ØªÙƒ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©</div>
            </div>
            <div style="flex:1">
              <div class="muted">Ø§Ù„Ù†Ø¸Ø§Ù… Ø­Ø³Ø¨ Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ ÙˆØ§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±ÙŠØ© Ù„ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù†ØªÙŠØ¬Ø©.</div>
            </div>
          </div>
          <div style="height:16px"></div>
          <div style="display:flex;gap:10px;justify-content:flex-end">
            <button id="sendAnswersBtn" class="primary">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª (WhatsApp)</button>
            <button id="goToExit" class="ghost">Ø§Ù„Ø®Ø±ÙˆØ¬</button>
          </div>
        </div>
        <div class="celebrate" aria-hidden="true" id="celebrateEl" style="z-index:1;pointer-events:none;opacity:1">
          <!-- Simple confetti-like visual (can be left decorative) -->
          <div style="font-size:28px;font-weight:900;color:gold;text-shadow:0 2px 10px rgba(0,0,0,0.5)">ğŸ‰ Ù…Ø¨Ø±ÙˆÙƒ! ğŸ‰</div>
        </div>
      </section>

      <!-- ØµÙØ­Ø© 12: Ø§Ù„Ø®Ø±ÙˆØ¬ -->
      <section id="page-12" class="page">
        <div class="center-box">
          <div class="card">
            <h3>Ù„Ù‚Ø¯ ØªÙ… Ø§Ù„Ø®Ø±ÙˆØ¬ Ù…Ù† Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</h3>
            <div style="height:8px"></div>
            <div class="muted">Ù„Ø§ ÙŠØ³Ù…Ø­ Ø¨Ø§Ù„Ø±Ø¬ÙˆØ¹ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ø¥Ù„Ø§ Ø¨ÙƒÙˆØ¯ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ÙØªØ­ (Ø®Ø§Øµ ÙˆØ³Ø±ÙŠ).</div>
            <div style="height:12px"></div>
            <div style="display:flex;gap:10px">
              <button id="sendAnswersBtnExit" class="primary">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª (WhatsApp)</button>
              <button id="openReopenBox" class="ghost">Ø§Ù„Ø®Ø±ÙˆØ¬</button>
            </div>
          </div>
        </div>
      </section>

    </div>

    <div class="controls">
      <button id="prevBtn" class="ghost">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
      <button id="nextBtn" class="ghost">Ø§Ù„ØªØ§Ù„ÙŠ</button>
      <div class="muted">ØµÙØ­Ø© <span id="pageIndex">1</span> / 12</div>
    </div>
  </div>
</div>

<!-- Enter notify (appears on page change) -->
<div id="enterNotify" class="enter-notify">
  <div class="modal-card" style="display:flex;gap:12px;align-items:center">
    <div class="check-circle"><div class="check-icon">âœ”</div></div>
    <div style="font-weight:700;font-size:18px" id="enterNotifyText">ØªÙ… Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„ØµÙØ­Ø©</div>
  </div>
</div>

<!-- Modal: password (for reopen after exit or time) -->
<div id="reopenModal" class="modal-overlay" style="display:none">
  <div class="modal-card">
    <div style="font-weight:800;font-size:18px;margin-bottom:8px">Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</div>
    <div class="muted" style="margin-bottom:12px">Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙˆØ¯ Ù„ÙØªØ­ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ù…Ù† Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©.</div>
    <input id="reopenInput" type="password" placeholder="...Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙˆØ¯" />
    <div style="height:12px"></div>
    <div style="display:flex;justify-content:flex-end;gap:8px">
      <button id="reopenCancel" class="ghost">Ø¥Ù„ØºØ§Ø¡</button>
      <button id="reopenConfirm" class="primary">ÙØªØ­</button>
    </div>
  </div>
</div>

<!-- Modal: time closed -->
<div id="timeClosedModal" class="modal-overlay" style="display:none">
  <div class="modal-card">
    <div style="font-weight:800;font-size:18px;margin-bottom:8px">ØªÙ… ØºÙ„Ù‚ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</div>
    <div class="muted" style="margin-bottom:12px">Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª. Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙˆØ¯ Ù„Ø¥Ø¹Ø§Ø¯Ø© ÙØªØ­ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±.</div>
    <input id="timeReopenInput" type="password" placeholder="...Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙˆØ¯" />
    <div style="height:12px"></div>
    <div style="display:flex;justify-content:flex-end;gap:8px">
      <button id="timeModalCancel" class="ghost">Ø¥ØºÙ„Ø§Ù‚</button>
      <button id="timeModalConfirm" class="primary">ÙØªØ­</button>
    </div>
  </div>
</div>

<script>
/*
  ÙƒØ§Ù…Ù„: 12 ØµÙØ­Ø©ØŒ 7 ØµÙØ­Ø§Øª Ø£ÙƒÙˆØ§Ø¯ØŒ 10 MCQØŒ 10 essaysØŒ Ù†ØªÙŠØ¬Ø©ØŒ Ø®Ø±ÙˆØ¬.
  Ø§Ù„Ù…Ø¤Ù‚Øª 12 Ø¯Ù‚ÙŠÙ‚Ø©. Ù„Ø§ Ù†ÙƒØ´Ù Ø£ÙƒÙˆØ§Ø¯ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ÙØªØ­ Ø£Ùˆ Ø£ÙŠ Ø³Ø±Ù‘ÙŠÙ‘Ø© Ø¹Ù„Ù‰ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©.
  Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„ØµØ­ÙŠØ­Ø© Ù„Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø³Ø¨Ø¹Ø© Ù…Ø­ÙÙˆØ¸Ø© Ø¯Ø§Ø®Ù„ÙŠØ§Ù‹ (Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù†ØªÙŠØ¬Ø©)ØŒ
  Ù„ÙƒÙ† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ø§ ÙŠØ±Ù‰ Ø£ÙŠ Ù†ØªÙŠØ¬Ø© ØªØµØ­ÙŠØ­ÙŠØ© Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø­Ù„.
*/

/* ========== Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ========== */
const PAGES = 12;
let currentPage = 1;
const pageIndexEl = document.getElementById('pageIndex');
const prevBtn = document.getElementById('prevBtn');
const nextBtn = document.getElementById('nextBtn');
const startBtn = document.getElementById('startBtn');
const timerDisplay = document.getElementById('timerDisplay');
const enterNotify = document.getElementById('enterNotify');
const enterNotifyText = document.getElementById('enterNotifyText');

const TOTAL_SECONDS = 12 * 60;
let timerRemaining = TOTAL_SECONDS;
let timerInterval = null;

/* Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… - Ø³Ù†Ø®Ø²Ù† Ù…Ø§ ÙƒØªØ¨Ù‡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (Ø§Ù„Ø£Ø¬ÙˆØ¨Ø© Ø§Ù„ÙØ¹Ù„ÙŠØ©) */
const answers = {
  meta: {name:'', email:'', phone:'', province:''},
  codes: {}, // page -> value entered (2..8)
  mcq: {},   // qIndex -> selected index (0..3)
  essays: {} // 1..10 -> text
};

/* Ù…ÙØ§ØªÙŠØ­ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„Ø³Ø±ÙŠØ© (Ù„Ø§ ØªØ¸Ù‡Ø± ÙÙŠ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©) â€” ØªÙØ³ØªØ®Ø¯Ù… Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†ØªÙŠØ¬Ø© */
const secretCodes = {2:'8075',3:'91053',4:'8846',5:'5907',6:'6189',7:'1637',8:'0927'};

/* Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±ÙŠ Ø§Ù„ØµØ­ÙŠØ­Ø© (index of option 0..3) */
const mcqCorrect = [1,1,1,1,2,1,1,2,2,1]; // Ø¨Ù…Ø§ ÙŠØªÙˆØ§ÙÙ‚ Ù…Ø¹ ØªØ³Ù„Ø³Ù„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©

/* Ø£ÙƒÙˆØ§Ø¯ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ÙØªØ­ (Ø³Ø±ÙŠÙ‘Ø©) â€” Ù„Ù† ØªØ¸Ù‡Ø± */
const REOPEN_EXIT = '55666777788888'; // Ù„ØµÙØ­Ø© Ø§Ù„Ø®Ø±ÙˆØ¬
const REOPEN_TIME = '11222333344444'; // Ø¹Ù†Ø¯ Ù†ÙØ§Ø¯ Ø§Ù„ÙˆÙ‚Øª

/* Ù…Ù†Ø¹ Ù…Ø­Ø§ÙˆÙ„Ø© Ù…ØªØ¹Ø¯Ø¯Ø© Ù„ÙƒÙ„ Ø¬Ù‡Ø§Ø² Ù…Ø§ Ù„Ù… ÙŠØ¹Ø§Ø¯ ÙØªØ­Ù‡ */
function markAttempted(){ localStorage.setItem('attempted','true'); }
function isAttempted(){ return localStorage.getItem('attempted') === 'true'; }

/* Ø­ÙØ¸ ÙˆØ§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„ØªÙ‚Ø¯Ù‘Ù… */
function saveProgress(){
  const payload = {answers, timerRemaining, currentPage, maxVisited: localStorage.getItem('maxVisited')||1};
  localStorage.setItem('progressData', JSON.stringify(payload));
}
function loadProgress(){
  const data = localStorage.getItem('progressData');
  if(!data) return;
  try{
    const p = JSON.parse(data);
    if(p.answers) Object.assign(answers, p.answers);
    if(p.timerRemaining) timerRemaining = p.timerRemaining;
    if(p.currentPage) currentPage = p.currentPage;
  }catch(e){}
}
loadProgress();

/* ========== ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ØªÙ†Ù‚Ù„ ÙˆØ§Ù„ØµÙØ­Ø§Øª ========== */
function showPage(n, showNotify=true){
  if(n<1) n=1; if(n>PAGES) n=PAGES;
  const maxVisited = Number(localStorage.getItem('maxVisited')||1);
  // Ø¹Ø¯Ù… Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„Ø±Ø¬ÙˆØ¹ Ù„ØµÙØ­Ø§Øª Ø³Ø§Ø¨Ù‚Ø©
  if(n < maxVisited){
    alert('ØºÙŠØ± Ù…Ø³Ù…ÙˆØ­ Ø¨Ø§Ù„Ø±Ø¬ÙˆØ¹ Ù„Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©.');
    return;
  }
  // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
  for(let i=1;i<=PAGES;i++){
    const el = document.getElementById('page-'+i);
    if(el) el.classList.toggle('active', i===n);
  }
  currentPage = n;
  pageIndexEl.textContent = `${currentPage}`;
  // ØªØ¹Ø·ÙŠÙ„ Ø²Ø± Ø§Ù„Ø³Ø§Ø¨Ù‚ Ù„Ùˆ Ø§Ù„ØµÙØ­Ø© >1
  prevBtn.disabled = currentPage > 1;
  // Ø³Ø¬Ù„ Ø£Ø¹Ù„Ù‰ ØµÙØ­Ø© Ø²Ø§Ø±Ù‡Ø§
  if(currentPage > maxVisited) localStorage.setItem('maxVisited', String(currentPage));
  saveProgress();
  // notify (enter) Ø¹Ù†Ø¯ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ â€” ÙŠØ¸Ù‡Ø± Ø«Ø§Ù†ÙŠØ© ÙˆØ§Ø­Ø¯Ø©
  if(showNotify){
    showEnterNotify(`ØªÙ… Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ ØµÙØ­Ø© ${getPageName(currentPage)}`);
  }
  // Ø¹Ù†Ø¯ Ø§Ù„ÙˆØµÙˆÙ„ Ù„ØµÙØ­Ø© Ø§Ù„Ù†ØªÙŠØ¬Ø©ØŒ Ø§Ø­Ø³Ø¨ Ù†ØªÙŠØ¬Ø©
  if(currentPage === 11){
    computeAndShowResult();
  }
}

/* Ø§Ø³Ù… Ø§Ù„ØµÙØ­Ø© Ù„Ø£ØºØ±Ø§Ø¶ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± */
function getPageName(n){
  if(n===1) return 'Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©';
  if(n>=2 && n<=8) return `ÙƒÙˆØ¯ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ ${n-1}`;
  if(n===9) return 'Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±ÙŠØ©';
  if(n===10) return 'Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ù…Ù‚Ø§Ù„ÙŠØ©';
  if(n===11) return 'Ø§Ù„Ù†ØªÙŠØ¬Ø©';
  if(n===12) return 'Ø§Ù„Ø®Ø±ÙˆØ¬';
  return '';
}

/* Ø¹Ø±Ø¶ Ø¥Ø´Ø¹Ø§Ø± Ø¯Ø®ÙˆÙ„ ØµÙØ­Ø© Ù…Ø¹ Ø¯Ø§Ø¦Ø±Ø© Ø§Ù„ØµØ­ Ø§Ù„Ø®Ø¶Ø±Ø§Ø¡ Ù„Ø«Ø§Ù†ÙŠØ© ÙˆØ§Ø­Ø¯Ø© */
let notifyTimeout = null;
function showEnterNotify(text){
  enterNotifyText.textContent = text;
  enterNotify.classList.add('show');
  clearTimeout(notifyTimeout);
  notifyTimeout = setTimeout(()=> enterNotify.classList.remove('show'), 1000);
}

/* Ø²Ø± Ø§Ù„Ø³Ø§Ø¨Ù‚ ÙˆØ§Ù„Ø§Ù„ØªØ§Ù„ÙŠ Ø§Ù„Ø¹Ø§Ù… */
prevBtn.addEventListener('click', ()=> showPage(currentPage-1));
nextBtn.addEventListener('click', ()=> {
  if(currentPage < PAGES) showPage(currentPage+1);
});

/* ========== START: Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ========== */
startBtn.addEventListener('click', ()=>{
  if(isAttempted()){
    alert('Ù‡Ø°Ø§ Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ø³ØªÙØ®Ø¯Ù… Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø± Ù…Ù† Ù‚Ø¨Ù„. Ø¥Ø°Ø§ Ù„Ø¯ÙŠÙƒ ÙƒÙˆØ¯ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ÙØªØ­ Ø§Ø³ØªØ®Ø¯Ù…Ù‡ Ù…Ù† ØµÙØ­Ø© Ø§Ù„Ø®Ø±ÙˆØ¬.');
    return;
  }
  // read meta
  answers.meta.name = document.getElementById('studentName').value.trim() || 'ØºÙŠØ± Ù…ÙØ¯Ø±Ø¬';
  answers.meta.email = document.getElementById('studentEmail').value.trim() || 'ØºÙŠØ± Ù…ÙØ¯Ø±Ø¬';
  answers.meta.phone = document.getElementById('studentPhone').value.trim() || 'ØºÙŠØ± Ù…ÙØ¯Ø±Ø¬';
  answers.meta.province = document.getElementById('studentProvince').value.trim() || 'ØºÙŠØ± Ù…ÙØ¯Ø±Ø¬';
  markAttempted();
  // go to page 2 and start timer
  showPage(2);
  startTimer();
});

/* ========== ØµÙØ­Ø§Øª Ø§Ù„Ø£ÙƒÙˆØ§Ø¯: ØªØ³Ø¬ÙŠÙ„ Ù…Ø§ ÙƒØªØ¨Ù‡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆØ§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ ========== */
for(let p=2;p<=8;p++){
  const btn = document.getElementById('nextP'+p);
  if(btn){
    btn.addEventListener('click', ()=>{
      const val = (document.getElementById('codeP'+p).value || '').trim();
      answers.codes[p] = val || 'Ù„Ù… ÙŠÙØ¯Ø®Ù„';
      saveProgress();
      // goto next
      showPage(p+1);
    });
  }
}

/* ========== MCQ: Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙˆÙ‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª ========== */
const mcqQuestions = [
  {q:"Ø£ÙˆÙ„ Ø®Ø·ÙˆØ© ÙÙŠ Ø±Ø­Ù„Ø© ØªØ·ÙˆÙŠØ± Ø§Ù„Ø°Ø§Øª Ù‡ÙŠ:", opts:["Ù…Ù‚Ø§Ø±Ù†Ø© Ù†ÙØ³Ùƒ Ø¨Ø§Ù„Ø¢Ø®Ø±ÙŠÙ†","Ù…Ø¹Ø±ÙØ© Ù†Ù‚Ø§Ø· Ù‚ÙˆØªÙƒ ÙˆØ¶Ø¹ÙÙƒ","Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø§Ù„Ø¹ÙŠÙˆØ¨","ØªØ¬Ø§Ù‡Ù„ Ø§Ù„Ù…Ø´Ø§Ø¹Ø±"]},
  {q:"Ø§Ù„ØªÙÙƒÙŠØ± Ø§Ù„Ø¥ÙŠØ¬Ø§Ø¨ÙŠ ÙŠØ¹Ù†ÙŠ:", opts:["Ø¥Ù†ÙƒØ§Ø± Ø§Ù„ÙˆØ§Ù‚Ø¹","Ø§Ù„Ù†Ø¸Ø± Ù„Ù„Ù…Ø´ÙƒÙ„Ø© Ù…Ù† Ø²Ø§ÙˆÙŠØ© Ø§Ù„Ø­Ù„","ØªØ¬Ø§Ù‡Ù„ Ø§Ù„ØµØ¹ÙˆØ¨Ø§Øª","Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø¸"]},
  {q:"Ù…Ù† Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø¹Ø§Ø·ÙÙŠ:", opts:["ÙƒØ¨Øª Ø§Ù„Ù…Ø´Ø§Ø¹Ø±","ÙÙ‡Ù… Ù…Ø´Ø§Ø¹Ø± Ù†ÙØ³Ùƒ ÙˆØ§Ù„Ø¢Ø®Ø±ÙŠÙ†","ØªØ¬Ù†Ù‘Ø¨ Ø§Ù„ØªÙØ§Ø¹Ù„ Ù…Ø¹ Ø§Ù„Ù†Ø§Ø³","Ø§Ù„Ø§Ù†ÙØ¹Ø§Ù„ Ø§Ù„Ø³Ø±ÙŠØ¹"]},
  {q:"Ø£ÙØ¶Ù„ Ø·Ø±ÙŠÙ‚Ø© Ù„ØªÙ†Ø¸ÙŠÙ… Ø§Ù„ÙˆÙ‚Øª:", opts:["Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ø¹Ø´ÙˆØ§Ø¦ÙŠ","ÙƒØªØ§Ø¨Ø© Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„ÙŠÙˆÙ…ÙŠØ© ÙˆØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ§Øª","ØªØ£Ø¬ÙŠÙ„ Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„ØµØ¹Ø¨Ø©","Ø§Ù„Ø¹Ù…Ù„ Ø¯ÙˆÙ† Ø±Ø§Ø­Ø©"]},
  {q:"Ø§Ù„ØªÙÙƒÙŠØ± Ø§Ù„Ù†Ù‚Ø¯ÙŠ ÙŠØ³Ø§Ø¹Ø¯ Ø¹Ù„Ù‰:", opts:["Ø§Ù„Ø­ÙØ¸ Ø§Ù„Ø³Ø±ÙŠØ¹","ØªÙ‚Ù„ÙŠØ¯ Ø§Ù„Ø¢Ø®Ø±ÙŠÙ†","ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…ÙˆØ§Ù‚Ù ÙˆØ§ØªØ®Ø§Ø° Ø§Ù„Ù‚Ø±Ø§Ø± Ø§Ù„ØµØ­ÙŠØ­","ØªØ¬Ù†Ù‘Ø¨ Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ø¬Ù…Ø§Ø¹ÙŠ"]},
  {q:"Ø§Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„ÙØ¹Ù‘Ø§Ù„ ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰:", opts:["ÙƒØ«Ø±Ø© Ø§Ù„ÙƒÙ„Ø§Ù…","ÙˆØ¶ÙˆØ­ Ø§Ù„ÙÙƒØ±Ø© ÙˆÙ„ØºØ© Ø§Ù„Ø¬Ø³Ø¯","Ø§Ù„ØµÙˆØª Ø§Ù„Ø¹Ø§Ù„ÙŠ","Ø§Ù„Ø¬Ø¯Ø§Ù„"]},
  {q:"Ù…Ù† ØµÙØ§Øª Ø§Ù„Ù‚Ø§Ø¦Ø¯ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ:", opts:["ÙØ±Ø¶ Ø§Ù„Ø³ÙŠØ·Ø±Ø©","ØªØ­ÙÙŠØ² Ø§Ù„ÙØ±ÙŠÙ‚ ÙˆØªØ´Ø¬ÙŠØ¹Ù‡","ØªØ¬Ø§Ù‡Ù„ Ø¢Ø±Ø§Ø¡ Ø§Ù„Ø¢Ø®Ø±ÙŠÙ†","Ø­Ø¨ Ø§Ù„Ø¸Ù‡ÙˆØ±"]},
  {q:"Ø¹Ù†Ø¯ Ù…ÙˆØ§Ø¬Ù‡Ø© Ø¶ØºØ· ÙƒØ¨ÙŠØ± ÙÙŠ Ø§Ù„Ø­ÙŠØ§Ø©ØŒ Ø§Ù„Ø£ÙØ¶Ù„:", opts:["Ø§Ù„Ø§Ø³ØªØ³Ù„Ø§Ù…","Ø§Ù„Ù‡Ø±ÙˆØ¨ Ù…Ù† Ø§Ù„Ù…ÙˆÙ‚Ù","ØªÙ‡Ø¯Ø¦Ø© Ø§Ù„Ù†ÙØ³ ÙˆØªØ¬Ø²Ø¦Ø© Ø§Ù„Ù…Ø´ÙƒÙ„Ø©","Ù„ÙˆÙ… Ø§Ù„Ø¢Ø®Ø±ÙŠÙ†"]},
  {q:"ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù ÙŠØ³Ø§Ø¹Ø¯ Ø¹Ù„Ù‰:", opts:["ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø­Ù…Ø§Ø³","Ø¶ÙŠØ§Ø¹ Ø§Ù„ÙˆÙ‚Øª","ÙˆØ¶ÙˆØ­ Ø§Ù„Ø·Ø±ÙŠÙ‚ ÙˆØ§Ù„ØªØ­ÙÙŠØ²","Ø²ÙŠØ§Ø¯Ø© Ø§Ù„ØªÙˆØªØ±"]},
  {q:"Ø§Ù„ØªØ¹Ø§ÙˆÙ† Ù…Ø¹ Ø§Ù„ÙØ±ÙŠÙ‚ ÙŠØ¹Ù†ÙŠ:", opts:["Ø§Ù„Ù…Ù†Ø§ÙØ³Ø©","Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© ÙÙŠ Ø§Ù„Ø£ÙÙƒØ§Ø± ÙˆØ§Ù„Ø¬Ù‡Ø¯","Ø§Ù„ØµÙ…Øª","ØªØ¬Ù†Ø¨ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ©"]}
];

function renderMCQ(){
  const mcqList = document.getElementById('mcqList');
  mcqList.innerHTML = '';
  mcqQuestions.forEach((m, idx)=>{
    const wrapper = document.createElement('div');
    wrapper.className = 'mcq-question';
    const title = document.createElement('div');
    title.style.fontWeight='700';
    title.textContent = `${idx+1}. ${m.q}`;
    wrapper.appendChild(title);
    m.opts.forEach((opt,j)=>{
      const op = document.createElement('div');
      op.className = 'opt';
      op.textContent = `${String.fromCharCode(65+j)}) ${opt}`;
      op.addEventListener('click', ()=>{
        answers.mcq[idx+1] = j;
        // visual
        wrapper.querySelectorAll('.opt').forEach(n=>n.classList.remove('selected'));
        op.classList.add('selected');
        saveProgress();
      });
      wrapper.appendChild(op);
    });
    mcqList.appendChild(wrapper);
  });
}
renderMCQ();

/* Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø§Ù„ØªØ§Ù„ÙŠ Ù…Ù† MCQ */
document.getElementById('nextFromMCQ').addEventListener('click', ()=>{
  // save progress (already saved on click)
  saveProgress();
  showPage(10); // go to essays
});

/* ========== Essays: Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù€10 ========== */
const essayPrompts = [
  "Ù…Ø§ Ù‡Ùˆ Ù‡Ø¯ÙÙƒ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ ÙÙŠ Ø§Ù„Ø­ÙŠØ§Ø©ØŸ",
  "ÙƒÙŠÙ ØªØ®Ø·Ø· Ù„ØªØ­Ù‚ÙŠÙ‚ Ø£Ù‡Ø¯Ø§ÙÙƒ Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠØ©ØŸ",
  "Ù…Ø§ Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª Ø§Ù„ØªÙŠ Ù‚Ø¯ ØªÙˆØ§Ø¬Ù‡Ù‡Ø§ Ø£Ø«Ù†Ø§Ø¡ ØªÙ†ÙÙŠØ° Ø®Ø·Ø·ÙƒØŸ",
  "Ù…Ø§ Ø£Ù‡Ù…ÙŠØ© ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ù‚ØµÙŠØ±Ø© Ø§Ù„Ù…Ø¯Ù‰ØŸ",
  "ÙƒÙŠÙ ØªØ³Ø§Ø¹Ø¯Ùƒ Ù…Ù‡Ø§Ø±Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙˆÙ‚Øª ÙÙŠ ØªØ­Ù‚ÙŠÙ‚ Ø£Ù‡Ø¯Ø§ÙÙƒØŸ",
  "Ù…Ø§ Ø§Ù„Ø£Ø¯ÙˆØ§Øª Ø£Ùˆ Ø§Ù„ÙˆØ³Ø§Ø¦Ù„ Ø§Ù„ØªÙŠ ØªØ³ØªØ®Ø¯Ù…Ù‡Ø§ ÙÙŠ Ø§Ù„ØªØ®Ø·ÙŠØ· Ø§Ù„Ø´Ø®ØµÙŠØŸ",
  "Ù…Ù† Ù‡Ùˆ Ø§Ù„Ø´Ø®Øµ Ø§Ù„Ø°ÙŠ ÙŠÙ„Ù‡Ù…Ùƒ ÙÙŠ Ø§Ù„Ø³Ø¹ÙŠ Ù†Ø­Ùˆ Ø§Ù„Ù†Ø¬Ø§Ø­ØŸ",
  "ÙƒÙŠÙ ØªØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„ÙØ´Ù„ Ø£Ùˆ Ø§Ù„Ø¥Ø®ÙØ§Ù‚ ÙÙŠ ØªØ­Ù‚ÙŠÙ‚ Ù‡Ø¯Ù Ù…Ø§ØŸ",
  "ÙƒÙŠÙ ØªÙ‚ÙŠÙ… ØªÙ‚Ø¯Ù…Ùƒ Ù†Ø­Ùˆ ØªØ­Ù‚ÙŠÙ‚ Ø£Ù‡Ø¯Ø§ÙÙƒØŸ",
  "Ù…Ø§ Ø§Ù„Ù†ØµÙŠØ­Ø© Ø§Ù„ØªÙŠ ØªÙ‚Ø¯Ù…Ù‡Ø§ Ù„Ø´Ø®Øµ ÙŠØ±ÙŠØ¯ Ø§Ù„Ø¨Ø¯Ø¡ ÙÙŠ Ø§Ù„ØªØ®Ø·ÙŠØ· Ù„Ù…Ø³ØªÙ‚Ø¨Ù„Ù‡ØŸ"
];

function renderEssays(){
  const container = document.getElementById('essaysContainer');
  container.innerHTML = '';
  essayPrompts.forEach((p, idx)=>{
    const wrapper = document.createElement('div');
    wrapper.className = 'card';
    const label = document.createElement('label');
    label.className = 'small';
    label.textContent = `${idx+1}. ${p}`;
    const ta = document.createElement('textarea');
    ta.id = 'essay'+(idx+1);
    ta.placeholder = 'Ø§ÙƒØªØ¨ Ø¥Ø¬Ø§Ø¨ØªÙƒ Ù‡Ù†Ø§...';
    // restore if exists
    if(answers.essays[idx+1]) ta.value = answers.essays[idx+1];
    wrapper.appendChild(label);
    wrapper.appendChild(ta);
    container.appendChild(wrapper);
  });
}
renderEssays();

/* Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù…Ù† essays Ø¥Ù„Ù‰ Ø§Ù„Ù†ØªÙŠØ¬Ø© */
document.getElementById('toResult').addEventListener('click', ()=>{
  // save essay answers
  essayPrompts.forEach((_,i)=>{
    const id = 'essay'+(i+1);
    answers.essays[i+1] = document.getElementById(id).value.trim() || 'Ù„Ù… ÙŠÙØ¬Ø¨';
  });
  saveProgress();
  showPage(11);
});

/* ========== Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†ØªÙŠØ¬Ø© ÙˆØ¥Ø¸Ù‡Ø§Ø±Ù‡Ø§ ========== */
function computeAndShowResult(){
  // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„ØµØ­ÙŠØ­Ø©
  let codeCorrect = 0; let totalCodes = 0;
  for(let p in secretCodes){
    totalCodes++;
    const entered = (answers.codes[p] || '').trim();
    if(entered === secretCodes[p]) codeCorrect++;
  }
  // Ø­Ø³Ø§Ø¨ MCQ ØµØ­ÙŠØ­Ø© Ø¨Ù…Ù‚Ø§Ø±Ù†Ø© Ù…Ø¹ mcqCorrect
  let mcqCorrectCount = 0;
  mcqQuestions.forEach((_, idx)=>{
    const user = answers.mcq[idx+1];
    if(typeof user !== 'undefined' && user === mcqCorrect[idx]) mcqCorrectCount++;
  });
  const totalMCQ = mcqQuestions.length;
  // ÙˆØ²Ù†: Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ ØªØ´ÙƒÙ„ 60%ØŒ MCQ ØªØ´ÙƒÙ„ 40% (ÙŠÙ…ÙƒÙ† ØªØ¹Ø¯ÙŠÙ„)
  const score = Math.round(((codeCorrect / totalCodes) * 0.6 + (mcqCorrectCount / totalMCQ) * 0.4) * 100);
  document.getElementById('scorePct').textContent = `${score}%`;
  saveProgress();
}

/* ========== Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¥Ù„Ù‰ WhatsApp ========== */
function buildWhatsAppMessage(){
  // time elapsed
  const rem = Number(localStorage.getItem('timerRemaining'));
  let elapsedStr = 'ØºÙŠØ± Ù…ØªØ§Ø­';
  if(!isNaN(rem)) {
    const elapsed = Math.max(0, TOTAL_SECONDS - rem);
    const mm = Math.floor(elapsed/60), ss = elapsed%60;
    elapsedStr = `${mm} Ø¯Ù‚ÙŠÙ‚Ø© Ùˆ ${ss} Ø«Ø§Ù†ÙŠØ©`;
  }
  const lines = [];
  lines.push('ğŸ“˜ Ø§Ø³Ù… Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±: Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ');
  lines.push('');
  lines.push(`ğŸ‘¤ Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨: ${answers.meta.name || 'ØºÙŠØ± Ù…ÙØ¯Ø±Ø¬'}`);
  lines.push(`ğŸ™ï¸ Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©: ${answers.meta.province || 'ØºÙŠØ± Ù…ÙØ¯Ø±Ø¬'}`);
  lines.push(`ğŸ“ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ: ${answers.meta.phone || 'ØºÙŠØ± Ù…ÙØ¯Ø±Ø¬'}`);
  lines.push(`ğŸ“§ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ: ${answers.meta.email || 'ØºÙŠØ± Ù…ÙØ¯Ø±Ø¬'}`);
  lines.push(`â±ï¸ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø³ØªØºØ±Ù‚: ${elapsedStr}`);
  lines.push('â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€');
  lines.push('âœï¸ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ù…Ù‚Ø§Ù„ÙŠØ©:');
  for(let i=1;i<=essayPrompts.length;i++){
    lines.push(`${i}- ${answers.essays[i] || 'Ù„Ù… ÙŠÙØ¬Ø¨'}`);
  }
  lines.push('â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€');
  lines.push('ğŸ§  Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±ÙŠØ©:');
  mcqQuestions.forEach((m, idx)=>{
    const userIdx = answers.mcq[idx+1];
    if(typeof userIdx === 'undefined') lines.push(`${idx+1}- Ù„Ù… ÙŠØ¬Ø§ÙˆØ¨`);
    else lines.push(`${idx+1}- ${String.fromCharCode(65+userIdx)} â€” ${m.opts[userIdx]}`);
  });
  lines.push('â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€');
  lines.push('ğŸ”¢ Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø¯Ø®ÙˆÙ„ (Ù…Ø§ ÙƒØªØ¨Ù‡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…):');
  for(let p=2;p<=8;p++){
    const qnum = p-1;
    lines.push(`${qnum}- ${answers.codes[p] || 'Ù„Ù… ÙŠÙØ¯Ø®Ù„'}`);
  }
  lines.push('â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€');
  lines.push(`ğŸ“Š Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©: ${document.getElementById('scorePct').textContent || '--%'}`);
  lines.push('â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€');
  lines.push('ğŸ“… ØªÙ… ØªÙˆÙ„ÙŠØ¯ Ù‡Ø°Ù‡ Ø§Ù„Ù†ØªÙŠØ¬Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨ÙˆØ§Ø³Ø·Ø© Ø§Ù„Ù†Ø¸Ø§Ù….');
  return encodeURIComponent(lines.join('\n'));
}

document.getElementById('sendAnswersBtn').addEventListener('click', ()=>{
  // ensure essays saved
  for(let i=1;i<=essayPrompts.length;i++) answers.essays[i] = document.getElementById('essay'+i).value.trim() || 'Ù„Ù… ÙŠÙØ¬Ø¨';
  computeAndShowResult(); saveProgress();
  const msg = buildWhatsAppMessage();
  const phone = '201505997273';
  window.open(`https://wa.me/${phone}?text=${msg}`, '_blank');
});
document.getElementById('sendAnswersBtnExit').addEventListener('click', ()=>{
  for(let i=1;i<=essayPrompts.length;i++) answers.essays[i] = document.getElementById('essay'+i).value?.trim() || 'Ù„Ù… ÙŠÙØ¬Ø¨';
  computeAndShowResult(); saveProgress();
  const msg = buildWhatsAppMessage();
  const phone = '201505997273';
  window.open(`https://wa.me/${phone}?text=${msg}`, '_blank');
});

/* ========== ØµÙØ­Ø© Ø§Ù„Ø®Ø±ÙˆØ¬: Ø¥Ø¸Ù‡Ø§Ø± ØµÙ†Ø¯ÙˆÙ‚ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ÙØªØ­ Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ "Ø§Ù„Ø®Ø±ÙˆØ¬" ========== */
document.getElementById('openReopenBox')?.addEventListener('click', ()=>{
  // open modal (reopen)
  document.getElementById('reopenModal').style.display = 'flex';
});
document.getElementById('goToExit').addEventListener('click', ()=> showPage(12));
document.getElementById('openReopenBox').addEventListener('click', ()=> {
  document.getElementById('reopenModal').style.display = 'flex';
});

/* reopen modal handlers */
document.getElementById('reopenCancel').addEventListener('click', ()=> document.getElementById('reopenModal').style.display = 'none');
document.getElementById('reopenConfirm').addEventListener('click', ()=> {
  const v = document.getElementById('reopenInput').value.trim();
  if(v === REOPEN_EXIT || v === REOPEN_TIME){
    // reset progress
    localStorage.removeItem('attempted');
    localStorage.removeItem('maxVisited');
    localStorage.removeItem('progressData');
    localStorage.removeItem('timerRemaining');
    // reset in-memory
    for(let k in answers){ if(typeof answers[k] === 'object') { for(let kk in answers[k]) delete answers[k][kk]; } else answers[k] = ''; }
    timerRemaining = TOTAL_SECONDS;
    document.getElementById('reopenModal').style.display = 'none';
    alert('ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ÙØªØ­ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±. Ø³ÙŠØ¹ÙˆØ¯ Ø¥Ù„Ù‰ ØµÙØ­Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©.');
    showPage(1,false);
  } else {
    alert('ÙƒÙˆØ¯ ØºÙŠØ± ØµØ­ÙŠØ­.');
  }
});

/* time modal handlers */
document.getElementById('timeModalCancel').addEventListener('click', ()=> document.getElementById('timeClosedModal').style.display = 'none');
document.getElementById('timeModalConfirm').addEventListener('click', ()=> {
  const v = document.getElementById('timeReopenInput').value.trim();
  if(v === REOPEN_TIME || v === REOPEN_EXIT){
    localStorage.removeItem('attempted');
    localStorage.removeItem('maxVisited');
    localStorage.removeItem('progressData');
    localStorage.removeItem('timerRemaining');
    for(let k in answers){ if(typeof answers[k] === 'object') { for(let kk in answers[k]) delete answers[k][kk]; } else answers[k] = ''; }
    timerRemaining = TOTAL_SECONDS;
    document.getElementById('timeClosedModal').style.display = 'none';
    alert('ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ÙØªØ­ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ø¹Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ÙˆÙ‚Øª.');
    showPage(1,false);
  } else alert('ÙƒÙˆØ¯ ØºÙŠØ± ØµØ­ÙŠØ­.');
});

/* ========== Ø§Ù„Ù…Ø¤Ù‚Øª (12 Ø¯Ù‚ÙŠÙ‚Ø©) ========== */
function startTimer(){
  if(timerInterval) return;
  const saved = Number(localStorage.getItem('timerRemaining'));
  if(!isNaN(saved) && saved>0) timerRemaining = saved;
  timerInterval = setInterval(()=>{
    timerRemaining--;
    localStorage.setItem('timerRemaining', String(timerRemaining));
    updateTimerDisplay();
    if(timerRemaining <= 0){
      clearInterval(timerInterval); timerInterval=null;
      // Ø¹Ø±Ø¶ Ù…ÙˆØ¯Ø§Ù„ ØºÙ„Ù‚ Ø§Ù„ÙˆÙ‚Øª Ù„ÙƒÙ† ÙÙ‚Ø· Ø¥Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¯Ø§Ø®Ù„ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± (Ù„Ù… ÙŠÙ†ØªÙ‡Ù)
      // Ø´Ø±Ø·: Ø¥Ø°Ø§ Ù„Ù… ÙŠØµÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„ØµÙØ­Ø© Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø£Ùˆ Ù„Ù„Ø®Ø±ÙˆØ¬
      if(currentPage !== 11 && currentPage !== 12){
        document.getElementById('timeClosedModal').style.display = 'flex';
        showPage(12,false); // Ø§Ø°Ù‡Ø¨ Ù„Ù„ØµÙØ­Ø© 12 (Ø§Ù„Ø®Ø±ÙˆØ¬)
      }
    }
  },1000);
  updateTimerDisplay();
}
function updateTimerDisplay(){
  const mm = Math.floor(Math.max(0,timerRemaining)/60).toString().padStart(2,'0');
  const ss = (timerRemaining%60).toString().padStart(2,'0');
  timerDisplay.textContent = `Ø§Ù„ÙˆÙ‚Øª: ${mm}:${ss}`;
}

/* Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©ØŒ Ø¥Ø°Ø§ Ø³Ø¨Ù‚ ÙˆØ¨Ø¯Ø£ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù†Ø¹ÙŠØ¯ Ø§Ù„Ø­Ø§Ù„Ø© */
window.addEventListener('load', ()=>{
  const attempted = isAttempted();
  const maxVisited = Number(localStorage.getItem('maxVisited')||1);
  if(attempted && maxVisited>1){
    showPage(maxVisited,false);
    const savedTimer = Number(localStorage.getItem('timerRemaining'));
    if(!isNaN(savedTimer) && savedTimer>0){
      timerRemaining = savedTimer;
      startTimer();
    }
  }
});

/* Ø­ÙØ¸ Ø¯ÙˆØ±ÙŠ */
setInterval(()=> saveProgress(), 4000);

/* ========== Ù…Ù†Ø¹ Ø§Ù„Ø±Ø¬ÙˆØ¹ Ø¹Ø¨Ø± Ø²Ø± Ø§Ù„Ù…ØªØµÙØ­ ========== */
history.pushState(null, document.title, location.href);
window.addEventListener('popstate', function (event) {
  history.pushState(null, document.title, location.href);
  alert('ØºÙŠØ± Ù…Ø³Ù…ÙˆØ­ Ø¨Ø§Ù„Ø±Ø¬ÙˆØ¹ Ù„Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©.');
});

/* ========== ØªÙ‡ÙŠØ¦Ø© Ø¨Ø¹Ø¶ Ø§Ù„Ø£Ø´ÙŠØ§Ø¡ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© ========== */
// render essays & mcq initial state already called
renderEssays();

// disable prev initially
prevBtn.disabled = true;
showPage(1,false);

/* ========== small UX: when user navigates by nextBtn we mark show notify = true ========== */
nextBtn.addEventListener('click', ()=> {
  const target = currentPage + 1;
  if(target <= PAGES) showPage(target,true);
});
prevBtn.addEventListener('click', ()=> { const target = currentPage - 1; if(target>=1) showPage(target,true); });

</script>
</body>
</html>